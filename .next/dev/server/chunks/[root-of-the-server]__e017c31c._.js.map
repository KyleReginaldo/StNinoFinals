{
  "version": 3,
  "sources": [],
  "sections": [
    {"offset": {"line": 40, "column": 0}, "map": {"version":3,"sources":["file:///Users/koyaemer/Development/StNinoFinals/lib/notifications.ts"],"sourcesContent":["// Simple TextBee notifier using fetch\n// Requires the following environment variables:\n// - TEXTBEE_API_KEY: API key for TextBee\n// - TEXTBEE_API_URL: Base URL for TextBee API (e.g., https://api.textbee.com/v1)\n// - TEXTBEE_SENDER_ID: Sender identifier or phone number assigned to your service\n\nexport async function sendSms(phone: string, message: string) {\n  if (!phone) {\n    console.warn('sendSms called without phone number')\n    return false\n  }\n\n  const apiKey = process.env.TEXTBEE_API_KEY\n  const apiUrl = process.env.TEXTBEE_API_URL || 'https://api.textbee.com/v1'\n  const sender = process.env.TEXTBEE_SENDER_ID || process.env.TEXTBEE_SENDER || process.env.SMS_SENDER || null\n\n  if (!apiKey) {\n    console.warn('TEXTBEE_API_KEY is not configured; skipping SMS send')\n    return false\n  }\n\n  try {\n    const url = `${apiUrl.replace(/\\/+$/,'')}/messages`\n    const payload: any = {\n      to: phone,\n      message: message,\n    }\n    if (sender) payload.from = sender\n\n    // Use global fetch (available in Node 18+)\n    const res = await fetch(url, {\n      method: 'POST',\n      headers: {\n        'Content-Type': 'application/json',\n        'Authorization': `Bearer ${apiKey}`,\n      },\n      body: JSON.stringify(payload),\n    })\n\n    if (!res.ok) {\n      const text = await res.text()\n      console.error('TextBee API error:', res.status, text)\n      return false\n    }\n\n    try {\n      const data = await res.json()\n      console.log('TextBee sent msg, id:', data?.id || 'unknown')\n    } catch (err) {\n      // non-JSON response, still okay\n    }\n\n    return true\n  } catch (err: any) {\n    console.error('Failed to send SMS using TextBee:', err?.message || err)\n    return false\n  }\n}\n"],"names":[],"mappings":"AAAA,sCAAsC;AACtC,gDAAgD;AAChD,yCAAyC;AACzC,iFAAiF;AACjF,kFAAkF;;;;;AAE3E,eAAe,QAAQ,KAAa,EAAE,OAAe;IAC1D,IAAI,CAAC,OAAO;QACV,QAAQ,IAAI,CAAC;QACb,OAAO;IACT;IAEA,MAAM,SAAS,QAAQ,GAAG,CAAC,eAAe;IAC1C,MAAM,SAAS,QAAQ,GAAG,CAAC,eAAe,IAAI;IAC9C,MAAM,SAAS,QAAQ,GAAG,CAAC,iBAAiB,IAAI,QAAQ,GAAG,CAAC,cAAc,IAAI,QAAQ,GAAG,CAAC,UAAU,IAAI;IAExG,IAAI,CAAC,QAAQ;QACX,QAAQ,IAAI,CAAC;QACb,OAAO;IACT;IAEA,IAAI;QACF,MAAM,MAAM,GAAG,OAAO,OAAO,CAAC,QAAO,IAAI,SAAS,CAAC;QACnD,MAAM,UAAe;YACnB,IAAI;YACJ,SAAS;QACX;QACA,IAAI,QAAQ,QAAQ,IAAI,GAAG;QAE3B,2CAA2C;QAC3C,MAAM,MAAM,MAAM,MAAM,KAAK;YAC3B,QAAQ;YACR,SAAS;gBACP,gBAAgB;gBAChB,iBAAiB,CAAC,OAAO,EAAE,QAAQ;YACrC;YACA,MAAM,KAAK,SAAS,CAAC;QACvB;QAEA,IAAI,CAAC,IAAI,EAAE,EAAE;YACX,MAAM,OAAO,MAAM,IAAI,IAAI;YAC3B,QAAQ,KAAK,CAAC,sBAAsB,IAAI,MAAM,EAAE;YAChD,OAAO;QACT;QAEA,IAAI;YACF,MAAM,OAAO,MAAM,IAAI,IAAI;YAC3B,QAAQ,GAAG,CAAC,yBAAyB,MAAM,MAAM;QACnD,EAAE,OAAO,KAAK;QACZ,gCAAgC;QAClC;QAEA,OAAO;IACT,EAAE,OAAO,KAAU;QACjB,QAAQ,KAAK,CAAC,qCAAqC,KAAK,WAAW;QACnE,OAAO;IACT;AACF"}},
    {"offset": {"line": 134, "column": 0}, "map": {"version":3,"sources":["file:///Users/koyaemer/Development/StNinoFinals/lib/supabaseAdmin.ts"],"sourcesContent":["import { Database } from '@/database.types'\nimport { createClient, type SupabaseClient } from '@supabase/supabase-js'\n\n/**\n * Supabase Admin Client for Server-Side Operations\n * \n * ‚ö†Ô∏è SECURITY WARNING: This client uses the SERVICE ROLE KEY\n * - Bypasses ALL Row Level Security (RLS) policies\n * - Full database access with no restrictions\n * - ONLY use in server-side code (API routes, Server Components)\n * - NEVER import or use in client-side components\n * \n * Use Cases:\n * - Admin operations requiring elevated privileges\n * - System-level database operations\n * - Background jobs and cron tasks\n */\n\nconst supabaseUrl = process.env.NEXT_PUBLIC_SUPABASE_URL\nconst serviceRoleKey = process.env.SUPABASE_SERVICE_ROLE_KEY\n\n/**\n * Creates and returns a Supabase admin client instance\n * \n * @returns SupabaseClient with full admin privileges\n * @throws Error if environment variables are not set\n * \n * @example\n * ```ts\n * // In API route or Server Component only\n * const supabaseAdmin = getSupabaseAdmin();\n * const { data } = await supabaseAdmin.from('users').select('*');\n * ```\n */\nexport function getSupabaseAdmin(): SupabaseClient<Database> {\n  if (!supabaseUrl || !serviceRoleKey) {\n    throw new Error('Missing Supabase admin env. Set NEXT_PUBLIC_SUPABASE_URL and SUPABASE_SERVICE_ROLE_KEY (server-only).')\n  }\n  \n  return createClient<Database>(supabaseUrl as string, serviceRoleKey as string, {\n    auth: {\n      autoRefreshToken: false,\n      persistSession: false,\n    },\n  })\n}\n\n\n"],"names":[],"mappings":";;;;AACA;;AAEA;;;;;;;;;;;;;CAaC,GAED,MAAM;AACN,MAAM,iBAAiB,QAAQ,GAAG,CAAC,yBAAyB;AAerD,SAAS;IACd,IAAI,CAAC,eAAe,CAAC,gBAAgB;QACnC,MAAM,IAAI,MAAM;IAClB;IAEA,OAAO,IAAA,mRAAY,EAAW,aAAuB,gBAA0B;QAC7E,MAAM;YACJ,kBAAkB;YAClB,gBAAgB;QAClB;IACF;AACF"}},
    {"offset": {"line": 176, "column": 0}, "map": {"version":3,"sources":["file:///Users/koyaemer/Development/StNinoFinals/app/api/admin/attendance-live/route.ts"],"sourcesContent":["import { sendSms } from '@/lib/notifications'\nimport { getSupabaseAdmin } from '@/lib/supabaseAdmin'\nimport { NextResponse } from 'next/server'\n\n\n\nconst timeoutModeExpiry = new Map<number, number>()\n\n\n\nfunction cleanupExpiredTimeouts() {\n  const now = Date.now()\n  for (const [timestamp, expiry] of timeoutModeExpiry.entries()) {\n    if (now > expiry) {\n      timeoutModeExpiry.delete(timestamp)\n    }\n  }\n}\n\n\nfunction isTimeoutModeActive(): boolean {\n  cleanupExpiredTimeouts() \n  const now = Date.now()\n  for (const expiry of timeoutModeExpiry.values()) {\n    if (now < expiry) {\n      return true\n    }\n  }\n  return false\n}\n\n\nexport async function OPTIONS(request: Request) {\n  return new NextResponse(null, {\n    status: 200,\n    headers: {\n      'Access-Control-Allow-Origin': '*',\n      'Access-Control-Allow-Methods': 'GET, POST, PUT, OPTIONS',\n      'Access-Control-Allow-Headers': 'Content-Type',\n    },\n  })\n}\n\nexport async function GET(request: Request) {\n  \n  const defaultHeaders = {\n    'Content-Type': 'application/json',\n    'Access-Control-Allow-Origin': '*',\n    'Access-Control-Allow-Methods': 'GET, POST, OPTIONS',\n    'Access-Control-Allow-Headers': 'Content-Type',\n  }\n\n  \n  try {\n    \n    const url = new URL(request.url)\n    console.log(\"=== GET REQUEST DEBUG ===\")\n    console.log(\"Request URL:\", url.toString())\n    console.log(\"Origin:\", request.headers.get('origin') || 'N/A')\n    console.log(\"Host:\", request.headers.get('host') || 'N/A')\n    console.log(\"Environment:\", process.env.NODE_ENV)\n    console.log(\"=========================\")\n    const { searchParams } = new URL(request.url)\n    const limit = parseInt(searchParams.get('limit') || '50')\n    const since = searchParams.get('since') \n\n    \n    let supabaseClient\n    try {\n      supabaseClient = getSupabaseAdmin()\n    } catch (clientError: any) {\n      console.error('Failed to get Supabase admin client:', clientError)\n      return NextResponse.json({\n        success: true, \n        records: [],\n        warning: 'Database client initialization failed',\n        error: process.env.NODE_ENV === 'development' ? clientError?.message : undefined,\n      }, { \n        status: 200, \n        headers: defaultHeaders,\n      })\n    }\n\n    if (!supabaseClient) {\n      return NextResponse.json({\n        success: true, \n        records: [],\n        warning: 'Database client not available',\n      }, { \n        status: 200, \n        headers: defaultHeaders,\n      })\n    }\n\n    \n    \n    let data: any[] = []\n    let error: any = null\n    \n    try {\n      console.log('Attempting to fetch attendance records...')\n      console.log('Limit:', limit)\n      console.log('Since:', since)\n      \n      \n      let querySuccess = false\n      \n      \n      try {\n        console.log('Method 1: Trying RPC function...')\n        const { data: rpcData, error: rpcError } = await supabaseClient.rpc('get_attendance_records', {\n          record_limit: limit,\n          since_time: since || undefined\n        })\n        \n        if (!rpcError && rpcData) {\n          data = rpcData as any[]\n          error = null\n          querySuccess = true\n          console.log('‚úì RPC query successful, records:', (data || []).length)\n        } else {\n          console.log('‚úó RPC failed:', rpcError?.message || 'RPC function not found')\n        }\n      } catch (rpcException: any) {\n        console.log('‚úó RPC exception:', rpcException.message)\n      }\n      \n      \n      if (!querySuccess) {\n        try {\n          console.log('Method 2: Trying direct query with explicit columns...')\n          let directQuery = supabaseClient\n      .from('attendance_records')\n            .select('id, scan_time, scan_type, user_id, rfid_card, rfid_tag, status, time_in, time_out, created_at, device_id')\n      .order('scan_time', { ascending: false })\n      .limit(limit)\n\n    if (since) {\n            directQuery = directQuery.gt('scan_time', since)\n          }\n          \n          const directResult = await directQuery\n          \n          if (!directResult.error && directResult.data) {\n            data = directResult.data || []\n            error = null\n            querySuccess = true\n            console.log('‚úì Direct query (minimal) successful, records:', (data || []).length)\n          } else {\n            \n            if (directResult.error?.code === 'PGRST200' || \n                directResult.error?.message?.includes('relationship') ||\n                directResult.error?.message?.includes('Could not find a relationship')) {\n              console.log('‚ö† PostgREST relationship error - returning empty records (this is OK)')\n              data = []\n              error = null\n              querySuccess = true \n            } else {\n              throw directResult.error\n            }\n          }\n        } catch (directError: any) {\n          \n          if (directError.code === 'PGRST200' || \n              directError.message?.includes('relationship') ||\n              directError.message?.includes('Could not find a relationship')) {\n            console.log('‚ö† PostgREST relationship error in catch - returning empty records')\n            data = []\n            error = null\n            querySuccess = true\n          } else {\n            console.error('‚úó Direct query failed:', directError)\n            \n            data = []\n            error = null\n            querySuccess = true\n          }\n        }\n      }\n      \n      \n      if (!querySuccess) {\n        console.log('‚ö† All query methods failed - returning empty records')\n        data = []\n        error = null\n      }\n    } catch (queryError: any) {\n      console.error('Query execution exception:', queryError)\n      console.error('Exception name:', queryError.name)\n      console.error('Exception message:', queryError.message)\n      console.error('Exception stack:', queryError.stack)\n      error = queryError\n    }\n\n    if (error) {\n      console.error('Database error:', error)\n      console.error('Error code:', error.code)\n      console.error('Error message:', error.message)\n      console.error('Error details:', error.details)\n      console.error('Error hint:', error.hint)\n      \n      \n      \n      return NextResponse.json({\n        success: true, \n        records: [],\n        warning: 'Unable to fetch attendance records from database',\n        error: process.env.NODE_ENV === 'development' ? error.message : undefined,\n        details: process.env.NODE_ENV === 'development' ? {\n          code: error.code,\n          message: error.message,\n          details: error.details,\n          hint: error.hint,\n        } : undefined,\n      }, { \n        status: 200, \n        headers: {\n          'Content-Type': 'application/json',\n          'Access-Control-Allow-Origin': '*',\n          'Access-Control-Allow-Methods': 'GET, POST, OPTIONS',\n          'Access-Control-Allow-Headers': 'Content-Type',\n        },\n      })\n    }\n\n    \n    const studentIds = [...new Set((data || []).map((r: any) => r.user_id).filter(Boolean))]\n    const studentMap: Record<string, any> = {}\n    const teacherMap: Record<string, any> = {}\n    \n    if (studentIds.length > 0) {\n      try {\n        \n        const { data: allStudents, error: studentsError } = await supabaseClient\n          .from('users')\n          .select('*')\n          .eq('role', 'student')\n          .limit(1000)\n        \n        if (!studentsError && allStudents) {\n          allStudents.forEach((student: any) => {\n            const studentNumberStr = (student.student_number || '').toString().trim()\n            const studentIdUuid = (student.id || '').toString().trim()\n            \n            if (studentNumberStr) studentMap[studentNumberStr] = student\n            if (studentIdUuid) studentMap[studentIdUuid] = student\n          })\n        }\n        \n        \n        const { data: allTeachers, error: teachersError } = await supabaseClient\n          .from('users')\n          .select('*')\n          .eq('role', 'teacher')\n          .limit(1000)\n        \n        if (!teachersError && allTeachers) {\n          allTeachers.forEach((teacher: any) => {\n            const teacherIdUuid = (teacher.id || '').toString().trim()\n            const teacherEmail = (teacher.email || '').toString().trim().toLowerCase()\n            const employeeNum = (teacher.employee_number || '').toString().trim()\n            \n            if (teacherIdUuid) teacherMap[teacherIdUuid] = teacher\n            if (teacherEmail) teacherMap[teacherEmail] = teacher\n            if (employeeNum) teacherMap[employeeNum] = teacher\n          })\n        }\n      } catch (fetchError: any) {\n        console.error('Error fetching students/teachers:', fetchError)\n        \n      }\n    }\n\n    \n    if (!data || !Array.isArray(data) || data.length === 0) {\n      console.log('üì≠ No attendance records found in database')\n      console.log('üí° This could mean:')\n      console.log('   1. No scans have been recorded yet')\n      console.log('   2. Database table is empty')\n      console.log('   3. ESP32 scans are not being saved (check POST endpoint logs)')\n      return NextResponse.json({\n        success: true,\n        records: [],\n        message: 'No attendance records found. Scans will appear here once recorded.'\n      }, {\n        status: 200,\n        headers: defaultHeaders,\n      })\n    }\n    \n    console.log(`‚úÖ Found ${(data || []).length} attendance records`)\n    if ((data || []).length > 0) {\n      console.log('üìÖ Sample record times:', data.slice(0, 3).map((r: any) => ({\n        scan_time: r.scan_time,\n        created_at: r.created_at,\n        id: r.id\n      })))\n    }\n\n    \n    const formattedRecords = (data || []).map((record: any) => {\n      \n      let scanType: 'timein' | 'timeout' | null = null\n      \n      if (record.time_in && record.scan_time === record.time_in) {\n        scanType = 'timein'\n      } else if (record.time_out && record.scan_time === record.time_out) {\n        scanType = 'timeout'\n      } else if (record.scan_type) {\n        scanType = record.scan_type.toLowerCase() === 'time_in' || record.scan_type.toLowerCase() === 'timein' ? 'timein' : \n                   record.scan_type.toLowerCase() === 'time_out' || record.scan_type.toLowerCase() === 'timeout' ? 'timeout' : null\n      } else if (record.type) {\n        scanType = record.type.toLowerCase() === 'time_in' || record.type.toLowerCase() === 'timein' ? 'timein' : \n                   record.type.toLowerCase() === 'time_out' || record.type.toLowerCase() === 'timeout' ? 'timeout' : null\n      }\n      \n      \n      const student = studentMap[record.user_id] || null\n      const teacher = teacherMap[record.user_id] || null\n      \n      \n      const isTeacher = !!teacher || (student && (\n        student.role === 'teacher' || \n        student.user_type === 'teacher' ||\n        (!student.student_number)\n      ))\n      \n      const person = teacher || student\n      \n      \n      console.log('üìã Formatting record:', {\n        id: record.id,\n        user_id: record.user_id,\n        rfid_card: record.rfid_card,\n        rfid_tag: record.rfid_tag,\n        person_found: !!person,\n        person_name: person ? `${person.first_name} ${person.last_name}` : 'None'\n      })\n      \n      return {\n      id: record.id,\n        studentId: record.user_id,\n        studentName: person\n          ? `${person.first_name || ''} ${person.middle_name || ''} ${person.last_name || ''}`.trim() || 'Unknown'\n          : 'Unknown',\n        gradeLevel: isTeacher ? null : (person?.grade_level || 'N/A'),\n        section: isTeacher ? null : (person?.section || 'N/A'),\n      scanTime: record.scan_time || record.created_at,\n      status: record.status || 'Present',\n      rfidCard: record.rfid_card || record.rfid_tag || 'N/A',\n        studentPhoto: person?.photo_url || null,\n        scanType: scanType,\n        timeIn: record.time_in || null,\n        timeOut: record.time_out || null,\n        isTeacher: isTeacher || false,\n        subject: isTeacher ? (person?.specialization || person?.department || 'N/A') : null,\n        role: person?.role || null,\n      }\n    })\n\n    console.log(`üì§ Returning ${(formattedRecords || []).length} formatted records to frontend`)\n    if ((formattedRecords || []).length > 0) {\n      console.log('üìÖ First record scan time:', formattedRecords[0]?.scanTime)\n      console.log('üìÖ Last record scan time:', formattedRecords[formattedRecords.length - 1]?.scanTime)\n    }\n\n    return NextResponse.json({\n      success: true,\n      records: formattedRecords,\n      count: formattedRecords.length,\n    }, {\n      status: 200,\n      headers: defaultHeaders,\n    })\n  } catch (error: any) {\n    console.error('Attendance records API error:', error)\n    console.error('Error stack:', error?.stack)\n    console.error('Error name:', error?.name)\n    console.error('Error message:', error?.message)\n    \n    \n    try {\n      return NextResponse.json(\n        {\n          success: true, \n          records: [],\n          warning: 'Unable to fetch attendance records',\n          error: error?.message || 'Internal server error',\n          details: process.env.NODE_ENV === 'development' ? {\n            stack: error?.stack,\n            name: error?.name,\n            message: error?.message,\n          } : undefined,\n        },\n        { \n          status: 200, \n          headers: defaultHeaders,\n        }\n      )\n    } catch (jsonError: any) {\n      \n      console.error('Failed to create JSON response:', jsonError)\n      return new NextResponse(\n        JSON.stringify({\n          success: true,\n          records: [],\n          warning: 'Service temporarily unavailable',\n        }),\n        {\n          status: 200,\n          headers: defaultHeaders,\n        }\n      )\n    }\n  }\n}\n\nexport async function POST(request: Request) {\n  \n  const postHeaders = {\n    'Content-Type': 'application/json',\n    'Access-Control-Allow-Origin': '*',\n    'Access-Control-Allow-Methods': 'GET, POST, OPTIONS',\n    'Access-Control-Allow-Headers': 'Content-Type',\n  }\n\n  \n  try {\n    \n    console.log(\"=== POST: ENVIRONMENT VARIABLES DEBUG ===\")\n    console.log(\"URL:\", process.env.NEXT_PUBLIC_SUPABASE_URL ? \"SET\" : \"MISSING\")\n    console.log(\"URL Value:\", process.env.NEXT_PUBLIC_SUPABASE_URL)\n    console.log(\"ANON:\", process.env.NEXT_PUBLIC_SUPABASE_ANON_KEY ? \"SET\" : \"MISSING\")\n    console.log(\"ANON Key (first 20 chars):\", process.env.NEXT_PUBLIC_SUPABASE_ANON_KEY?.substring(0, 20) || \"MISSING\")\n    console.log(\"SERVICE:\", process.env.SUPABASE_SERVICE_ROLE_KEY ? \"SET\" : \"MISSING\")\n    console.log(\"SERVICE Key (first 20 chars):\", process.env.SUPABASE_SERVICE_ROLE_KEY?.substring(0, 20) || \"MISSING\")\n    console.log(\"==========================================\")\n\n    let scanData: any = null\n    try {\n      scanData = await request.json()\n    } catch (jsonError: any) {\n      console.error('Error parsing request JSON:', jsonError)\n      return NextResponse.json(\n        { \n          success: false, \n          error: 'Invalid JSON in request body',\n          message: 'Please ensure the request contains valid JSON',\n        },\n        { \n          status: 200,\n          headers: postHeaders,\n        }\n      )\n    }\n    \n    if (!scanData) {\n      return NextResponse.json(\n        { \n          success: false, \n          error: 'Request body is required',\n          message: 'Please include RFID card data in the request',\n        },\n        { \n          status: 200,\n          headers: postHeaders,\n        }\n      )\n    }\n    \n    \n    if (!scanData.studentId && !scanData.rfidCard) {\n      return NextResponse.json(\n          { \n            success: false, \n            error: 'Student ID or RFID Card is required',\n            records: [],\n          },\n          {\n            status: 200, \n            headers: {\n              'Content-Type': 'application/json',\n              'Access-Control-Allow-Origin': '*',\n              'Access-Control-Allow-Methods': 'GET, POST, OPTIONS',\n              'Access-Control-Allow-Headers': 'Content-Type',\n            },\n          }\n        )\n      }\n\n    \n    \n    const supabaseClient = getSupabaseAdmin()\n    \n    if (!supabaseClient) {\n        console.error('Supabase client not initialized')\n        if (process.env.NODE_ENV === 'development') {\n          return NextResponse.json({\n            success: true,\n            message: 'Scan recorded (dev mode - not saved to database)',\n          })\n        }\n        return NextResponse.json(\n          { \n            success: false, \n            error: 'Database service not configured. Please check your environment variables.',\n            records: [],\n          },\n          { \n            status: 200, \n            headers: {\n              'Content-Type': 'application/json',\n              'Access-Control-Allow-Origin': '*',\n              'Access-Control-Allow-Methods': 'GET, POST, OPTIONS',\n              'Access-Control-Allow-Headers': 'Content-Type',\n            },\n          }\n        )\n      }\n\n      \n      const today = new Date()\n      today.setHours(0, 0, 0, 0)\n      const todayStart = today.toISOString()\n      const todayEnd = new Date(today)\n      todayEnd.setHours(23, 59, 59, 999)\n      const todayEndISO = todayEnd.toISOString()\n\n      \n      let studentId = scanData.studentId\n      if (!studentId && scanData.rfidCard) {\n        \n        let rfidNormalized = scanData.rfidCard.toString().trim().toUpperCase().replace(/\\s+/g, '')\n        \n        const rfidNoLeadingZeros = rfidNormalized.replace(/^0+/, '')\n        \n        console.log(`Searching for student with RFID: ${rfidNormalized} (also trying: ${rfidNoLeadingZeros})`)\n        \n        \n        const { data: allStudents, error: fetchError } = await supabaseClient\n          .from('users')\n          .select('*')\n          .eq('role', 'student')\n          .limit(1000)\n\n        if (fetchError) {\n          console.error('Error fetching students:', fetchError)\n          return NextResponse.json(\n            { \n              success: false, \n              error: `Database error: ${fetchError.message}`,\n              searchedRfid: rfidNormalized,\n              records: [],\n            },\n            { \n              status: 200, \n              headers: {\n                'Content-Type': 'application/json',\n                'Access-Control-Allow-Origin': '*',\n                'Access-Control-Allow-Methods': 'GET, POST, OPTIONS',\n                'Access-Control-Allow-Headers': 'Content-Type',\n              },\n            }\n          )\n        }\n\n        \n        \n        console.log(`Checking teachers first for RFID: ${rfidNormalized}`)\n        const { data: allTeachers, error: teachersError } = await supabaseClient\n          .from('users')\n          .select('*')\n          .eq('role', 'teacher')\n          .limit(1000)\n        \n        let matchedTeacher = null\n        if (!teachersError && allTeachers) {\n          \n          const teachers = (allTeachers || []).filter((teacher: any) => {\n            const rfid = (teacher.rfid || '').toString().trim().toUpperCase()\n            \n            return rfid === rfidNormalized || rfid === rfidNoLeadingZeros ||\n                   rfid.includes(rfidNormalized)\n          })\n          \n          if (teachers && teachers.length > 0) {\n            matchedTeacher = teachers[0]\n            console.log(`‚úÖ Found teacher FIRST: ${matchedTeacher.first_name || 'Unknown'} ${matchedTeacher.last_name || ''}`)\n            \n            studentId = matchedTeacher.id?.toString()\n            \n            if (!studentId) {\n              console.error('‚ùå Teacher found but has no UUID:', matchedTeacher)\n              return NextResponse.json(\n                { \n                  success: false, \n                  error: 'Teacher record is invalid (missing UUID). Please contact administrator.',\n                },\n                { \n                  status: 200,\n                  headers: postHeaders,\n                }\n              )\n            }\n          }\n        }\n        \n        \n        if (!matchedTeacher) {\n          console.log(`No teacher found, checking students for RFID: ${rfidNormalized}`)\n          \n          \n          const students = (allStudents || []).filter((student: any) => {\n            const rfid = (student.rfid || '').toString().trim().toUpperCase()\n            \n            \n            return rfid === rfidNormalized || rfid === rfidNoLeadingZeros ||\n                   rfid.includes(rfidNormalized)\n          })\n\n          if (!students || students.length === 0) {\n            \n            console.log(`‚ùå No student or teacher found with RFID: ${rfidNormalized}`)\n            return NextResponse.json(\n              { \n                success: false, \n                error: `No student or teacher found for RFID: ${rfidNormalized}. Please assign this RFID card in the admin panel.`,\n                searchedRfid: rfidNormalized,\n                message: `RFID ${rfidNormalized} not assigned to any student or teacher`\n              },\n              { \n                status: 404,\n                headers: {\n                  'Access-Control-Allow-Origin': '*',\n                  'Access-Control-Allow-Methods': 'GET, POST, OPTIONS',\n                  'Access-Control-Allow-Headers': 'Content-Type',\n                },\n              }\n            )\n          } else {\n            \n            const matchedStudent = students[0]\n            console.log(`Found student: ${matchedStudent.first_name || 'Unknown'} ${matchedStudent.last_name || ''}`)\n            \n            \n            studentId = matchedStudent.id?.toString()\n            \n            if (!studentId) {\n              console.error('‚ùå Student found but has no UUID:', matchedStudent)\n              return NextResponse.json(\n                { \n                  success: false, \n                  error: 'Student record is invalid (missing UUID). Please contact administrator.',\n                },\n                { \n                  status: 200,\n                  headers: postHeaders,\n                }\n              )\n            }\n          }\n        }\n      }\n\n      \n      \n      let todayRecords: any[] = []\n      let checkError: any = null\n      \n      \n      const { data: allTodayRecords, error: fetchError } = await supabaseClient\n        .from('attendance_records')\n        .select('id, scan_type, scan_time, time_in, time_out, user_id')\n        .gte('scan_time', todayStart)\n        .lte('scan_time', todayEndISO)\n        .order('scan_time', { ascending: true })\n      \n      if (fetchError) {\n        checkError = fetchError\n        console.error('Error fetching today records:', fetchError)\n      } else if (allTodayRecords) {\n        \n        todayRecords = allTodayRecords.filter((r: any) => {\n          const rId = (r.user_id || '').toString().trim()\n          const sId = (studentId || '').toString().trim()\n          return rId === sId || rId === studentId || sId === r.user_id\n        })\n      }\n\n      if (checkError) {\n        console.error('Error checking existing records:', checkError)\n      }\n\n      \n      const hasTimeIn = todayRecords.some((r: any) => \n        r.scan_type === 'timein' || r.scan_type === 'time_in' || r.time_in\n      )\n      const hasTimeOut = todayRecords.some((r: any) => \n        r.scan_type === 'timeout' || r.scan_type === 'time_out' || r.time_out\n      )\n\n      \n      if (hasTimeIn && hasTimeOut) {\n        console.log('‚ö†Ô∏è Student has already timed in and out today')\n        return NextResponse.json({\n          success: false,\n          message: 'You have completed your attendance for today.',\n          error: 'Already completed attendance for today',\n          hasTimeIn: true,\n          hasTimeOut: true,\n        }, {\n          status: 200,\n          headers: postHeaders,\n        })\n      }\n\n      \n      const currentTime = new Date().toISOString()\n      let scanType: 'timein' | 'timeout' = 'timein'\n      let timeIn = null\n      let timeOut = null\n\n      \n      const timeoutModeActive = isTimeoutModeActive()\n      \n      if (hasTimeIn && !hasTimeOut) {\n        \n        scanType = 'timeout'\n        timeOut = currentTime\n        \n        \n        const timeInRecord = todayRecords\n          .filter((r: any) => r.scan_type === 'timein' || r.scan_type === 'time_in')\n          .sort((a: any, b: any) => new Date(b.scan_time).getTime() - new Date(a.scan_time).getTime())[0]\n        \n        if (timeInRecord) {\n          timeIn = timeInRecord.time_in || timeInRecord.scan_time\n        }\n        \n        console.log('‚è∞ Student already timed in today - forcing timeout')\n      } else if (timeoutModeActive && !hasTimeIn) {\n        \n        scanType = 'timein'\n        timeIn = currentTime\n        console.log('‚ö†Ô∏è Timeout mode active but no time in yet - recording as time in')\n      } else if (timeoutModeActive && hasTimeIn) {\n        \n        scanType = 'timeout'\n        timeOut = currentTime\n        \n        const timeInRecord = todayRecords\n          .filter((r: any) => r.scan_type === 'timein' || r.scan_type === 'time_in')\n          .sort((a: any, b: any) => new Date(b.scan_time).getTime() - new Date(a.scan_time).getTime())[0]\n        \n        if (timeInRecord) {\n          timeIn = timeInRecord.time_in || timeInRecord.scan_time\n        }\n        \n        console.log('‚è∞ Timeout mode active with existing time in - recording as timeout')\n      } else {\n        \n        scanType = 'timein'\n        timeIn = currentTime\n        console.log('‚úÖ Recording as time in (default)')\n      }\n\n      \n      \n      const attendanceRecord: any = {\n        user_id: studentId,\n      }\n      \n      \n      const rfidValue = scanData.rfidCard || ''\n      if (rfidValue) {\n        attendanceRecord.rfid_card = rfidValue\n        attendanceRecord.rfid_tag = rfidValue  \n      } else {\n        \n        attendanceRecord.rfid_card = ''\n        attendanceRecord.rfid_tag = ''\n      }\n      \n      \n      \n      \n      \n      \n      attendanceRecord.scan_time = currentTime\n      attendanceRecord.scan_type = scanType\n      attendanceRecord.time_in = timeIn\n      attendanceRecord.time_out = timeOut\n      attendanceRecord.status = scanType === 'timein' ? 'Present' : 'Present'\n      attendanceRecord.created_at = currentTime\n      \n      \n      attendanceRecord.type = scanType\n      \n      \n      console.log('üíæ Inserting attendance record:', {\n        user_id: attendanceRecord.user_id,\n        rfid_card: attendanceRecord.rfid_card,\n        scan_type: attendanceRecord.scan_type,\n        scan_time: attendanceRecord.scan_time\n      })\n      \n      const { data: newRecord, error: insertError } = await supabaseClient\n        .from('attendance_records')\n        .insert([attendanceRecord])\n        .select('*, user_id(*)')\n        .single()\n\n      if (insertError) {\n        console.error('‚ùå Insert failed:', insertError)\n        console.error('Database error:', insertError)\n        \n        \n        if (process.env.NODE_ENV === 'development') {\n          console.log('Scan data (dev mode):', { studentId, scanType, timeIn, timeOut })\n          return NextResponse.json({\n            success: true,\n            message: 'Scan recorded (dev mode - not saved to database)',\n            scanType,\n            timeIn,\n            timeOut,\n          }, {\n            headers: {\n              'Access-Control-Allow-Origin': '*',\n              'Access-Control-Allow-Methods': 'GET, POST, OPTIONS',\n              'Access-Control-Allow-Headers': 'Content-Type',\n            },\n          })\n        }\n        \n        return NextResponse.json(\n          { \n            success: false, \n            error: insertError.message,\n            hint: 'Please check that all required columns exist in attendance_records table. Run create-attendance-table.sql in Supabase.',\n            records: [],\n          },\n          { \n            status: 200, \n            headers: {\n              'Content-Type': 'application/json',\n              'Access-Control-Allow-Origin': '*',\n              'Access-Control-Allow-Methods': 'GET, POST, OPTIONS',\n              'Access-Control-Allow-Headers': 'Content-Type',\n            },\n          }\n        )\n      }\n\n      \n      \n      let personInfo: any = null\n      let isTeacher = false\n      \n      if (studentId) {\n        \n        const { data: allStudents } = await supabaseClient\n          .from('users')\n          .select('*')\n          .eq('role', 'student')\n          .limit(1000)\n        \n        if (allStudents) {\n          \n          const studentIdStr = (studentId || '').toString().trim()\n          personInfo = allStudents.find((student: any) => {\n            const sNum = (student.student_number || '').toString().trim()\n            const sUuid = (student.id || '').toString().trim()\n            return sNum === studentIdStr || sUuid === studentIdStr\n          }) || null\n        }\n        \n        \n        if (!personInfo) {\n          const { data: allTeachers } = await supabaseClient\n            .from('users')\n            .select('*')\n            .eq('role', 'teacher')\n            .limit(1000)\n          \n          if (allTeachers) {\n            const personIdStr = (studentId || '').toString().trim()\n            personInfo = allTeachers.find((teacher: any) => {\n              const tNum = (teacher.employee_number || '').toString().trim()\n              const tUuid = (teacher.id || '').toString().trim()\n              const tEmail = (teacher.email || '').toString().trim().toLowerCase()\n              return tNum === personIdStr || tUuid === personIdStr || tEmail === personIdStr\n            }) || null\n            \n            if (personInfo) {\n              isTeacher = true\n            }\n          }\n        }\n      }\n\n      \n      const formattedRecord = {\n        id: newRecord.id,\n        studentId: newRecord.user_id?.student_number || studentId,\n        studentName: personInfo\n          ? `${personInfo.first_name || personInfo.firstName || ''} ${personInfo.last_name || personInfo.lastName || ''}`.trim() || personInfo.name || 'Unknown'\n          : 'Unknown',\n        gradeLevel: isTeacher ? null : (personInfo?.grade_level || personInfo?.gradeLevel || 'N/A'),\n        section: isTeacher ? null : (personInfo?.section || 'N/A'),\n        scanTime: newRecord.scan_time || newRecord.created_at,\n        status: newRecord.status || 'Present',\n        rfidCard: newRecord.rfid_card || scanData.rfidCard || 'N/A',\n        studentPhoto: personInfo?.photo_url || personInfo?.profile_picture || personInfo?.picture || null,\n        scanType: scanType,\n        timeIn: newRecord.time_in || null,\n        timeOut: newRecord.time_out || null,\n        isTeacher: isTeacher,\n        subject: isTeacher ? (personInfo?.subject || personInfo?.subjects || personInfo?.subject_taught || 'N/A') : null,\n      }\n\n      console.log('‚úÖ Scan saved successfully!', {\n        id: newRecord.id,\n        student: formattedRecord.studentName,\n        scanType: scanType,\n        scanTime: formattedRecord.scanTime\n      })\n\n      \n      try {\n        \n        if (!isTeacher && scanType === 'timein') {\n          \n          let parentPhone: string | null = null\n\n          \n          try {\n            const parentRecords: any[] = []\n\n            \n            const parentId = personInfo?.parent_id || personInfo?.parentId || null\n            if (parentId) {\n              const { data: parentRecord, error: pErr } = await supabaseClient\n                .from('users')\n                .select('id, phone, mobile, phone_number, email')\n                .eq('id', parentId)\n                .eq('role','parent')\n                .limit(1)\n                .single()\n              if (!pErr && parentRecord) parentRecords.push(parentRecord)\n            }\n\n            \n            const parentEmail = personInfo?.parent_email || personInfo?.parentEmail || null\n            if (!parentRecords.length && parentEmail) {\n              const { data: parentRecord2, error: pErr2 } = await supabaseClient\n                .from('users')\n                .select('id, phone, mobile, phone_number, email')\n                .ilike('email', parentEmail)\n                .limit(1)\n                .single()\n              if (!pErr2 && parentRecord2) parentRecords.push(parentRecord2)\n            }\n\n            \n            if (!parentRecords.length && (personInfo?.student_id || personInfo?.student_number || personInfo?.id)) {\n              const sId = personInfo?.student_id || personInfo?.student_number || personInfo?.id\n              try {\n                const { data: linkedParentIds } = await supabaseClient\n                  .from('user_relationships')\n                  .select('parent_id')\n                  .eq('student_id', sId)\n                  .limit(10)\n                if (linkedParentIds && linkedParentIds.length > 0) {\n                  \n                  const parentIds = linkedParentIds.map((r: any) => r.parent_id).filter(Boolean)\n                  if (parentIds.length > 0) {\n                    const { data: parentsFromLink } = await supabaseClient\n                      .from('users')\n                      .select('id, phone, mobile, phone_number, email')\n                      .eq('role', 'parent')\n                      .in('id', parentIds)\n                    if (parentsFromLink) parentRecords.push(...parentsFromLink)\n                  }\n                }\n              } catch (linkError) {\n                \n              }\n            }\n\n            \n            if (parentRecords && parentRecords.length > 0) {\n              const p = parentRecords[0]\n              parentPhone = p?.phone || p?.mobile || p?.phone_number || null\n            }\n          } catch (parentQueryError) {\n            console.warn('Unable to query parents table for phone number:', parentQueryError)\n          }\n\n          \n          if (!parentPhone && personInfo) {\n            const possibleParentFields = [\n              'parent_phone',\n              'parentPhone',\n              'parent_contact',\n              'parentContact',\n              'parent_mobile',\n              'parentMobile',\n              'phone', \n              'emergency_contact',\n              'emergencyContact'\n            ]\n            for (const f of possibleParentFields) {\n              const val = personInfo[f]\n              if (val) {\n                parentPhone = val\n                break\n              }\n            }\n          }\n\n          \n          if (parentPhone) {\n            \n            const smsEnabled = (process.env.SMS_ON_SCAN_ENABLED || 'false').toLowerCase()\n            if (smsEnabled !== 'true' && smsEnabled !== '1') {\n              console.log('SMS notifications are disabled (SMS_ON_SCAN_ENABLED is not set to true)')\n            } else {\n              \n              let toPhone = parentPhone.toString().trim()\n              if (!toPhone.startsWith('+')) {\n                \n                const defaultCountryCode = process.env.DEFAULT_PHONE_COUNTRY_CODE || ''\n                if (defaultCountryCode) {\n                  toPhone = `${defaultCountryCode}${toPhone}`\n                }\n              }\n\n              const smsTemplate = process.env.SMS_ON_SCAN_TEMPLATE || 'Dear parent, {studentName} ({gradeLevel} - {section}) was recorded present at {scanTime}. ‚Äî Sto Ni√±o Portal'\n              const message = smsTemplate\n                .replace('{studentName}', formattedRecord.studentName)\n                .replace('{gradeLevel}', formattedRecord.gradeLevel || 'N/A')\n                .replace('{section}', formattedRecord.section || 'N/A')\n                .replace('{scanTime}', formattedRecord.scanTime || new Date().toISOString())\n\n              const smsSent = await sendSms(toPhone, message)\n              console.log('SMS notify result:', smsSent)\n            }\n          } else {\n            console.log('No parent phone found for student, skipping SMS')\n          }\n        }\n      } catch (smsError) {\n        console.error('SMS notification error:', smsError)\n      }\n\n      return NextResponse.json({\n        success: true,\n        record: formattedRecord,\n        message: `Time ${scanType === 'timein' ? 'In' : 'Out'} recorded successfully`,\n      }, {\n        status: 200,\n        headers: postHeaders,\n      })\n  } catch (error: any) {\n    \n    console.error('CRITICAL: Unhandled error in POST handler:', error)\n    console.error('Error stack:', error?.stack)\n    console.error('Error name:', error?.name)\n    console.error('Error message:', error?.message)\n    \n    \n    return NextResponse.json({\n      success: false,\n      error: process.env.NODE_ENV === 'development' ? error?.message : 'Internal server error',\n      records: [],\n      warning: 'Service error occurred',\n    }, {\n      status: 200,\n      headers: postHeaders,\n    })\n  }\n}\n\n\nexport async function PUT(request: Request) {\n  const putHeaders = {\n    'Content-Type': 'application/json',\n    'Access-Control-Allow-Origin': '*',\n    'Access-Control-Allow-Methods': 'GET, POST, PUT, OPTIONS',\n    'Access-Control-Allow-Headers': 'Content-Type',\n  }\n\n  try {\n    const body = await request.json()\n    const { action } = body\n\n    if (action === 'enable-timeout') {\n      \n      const now = Date.now()\n      const expiry = now + 5000 \n      const timestamp = now\n      \n      timeoutModeExpiry.set(timestamp, expiry)\n      \n      console.log('‚è∞ Timeout mode enabled for 5 seconds')\n      \n      return NextResponse.json(\n        {\n          success: true,\n          message: 'Timeout mode enabled for 5 seconds',\n          expiresAt: expiry,\n        },\n        {\n          status: 200,\n          headers: putHeaders,\n        }\n      )\n    } else {\n      return NextResponse.json(\n        {\n          success: false,\n          error: 'Invalid action',\n        },\n        {\n          status: 400,\n          headers: putHeaders,\n        }\n      )\n    }\n  } catch (error: any) {\n    console.error('Error in PUT handler:', error)\n    return NextResponse.json(\n      {\n        success: false,\n        error: error?.message || 'Internal server error',\n      },\n      {\n        status: 200,\n        headers: putHeaders,\n      }\n    )\n  }\n}\n"],"names":[],"mappings":"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"}}]
}