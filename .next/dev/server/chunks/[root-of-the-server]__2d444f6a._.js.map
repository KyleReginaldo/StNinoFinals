{
  "version": 3,
  "sources": [],
  "sections": [
    {"offset": {"line": 76, "column": 0}, "map": {"version":3,"sources":["file:///Users/koyaemer/Development/StNinoFinals/lib/supabaseClient.ts"],"sourcesContent":["// lib/supabaseClient.ts\nimport { Database } from '@/database.types'\nimport { createClient } from '@supabase/supabase-js'\n\n/**\n * Supabase Client for Client-Side Operations\n * \n * This client uses the ANON key and is safe to use in browser code.\n * It respects Row Level Security (RLS) policies in Supabase.\n * \n * DO NOT use service role key here - it bypasses RLS and is a security risk.\n * For admin operations, use getSupabaseAdmin() in server-side code only.\n */\n\n// Get environment variables\nconst supabaseUrl = process.env.NEXT_PUBLIC_SUPABASE_URL!\nconst supabaseAnonKey = process.env.NEXT_PUBLIC_SUPABASE_ANON_KEY!\n\n// Validate that environment variables are set\nif (!supabaseUrl || !supabaseAnonKey) {\n  throw new Error('Missing Supabase environment variables')\n}\n\n/**\n * Supabase client instance with typed database schema\n * Use this for all client-side database operations\n */\nexport const supabase = createClient<Database>(supabaseUrl, supabaseAnonKey)"],"names":[],"mappings":"AAAA,wBAAwB;;;;;AAExB;;AAEA;;;;;;;;CAQC,GAED,4BAA4B;AAC5B,MAAM;AACN,MAAM;AAEN,8CAA8C;AAC9C;;AAQO,MAAM,WAAW,IAAA,mRAAY,EAAW,aAAa"}},
    {"offset": {"line": 108, "column": 0}, "map": {"version":3,"sources":["file:///Users/koyaemer/Development/StNinoFinals/app/api/student/dashboard/route.ts"],"sourcesContent":["import { supabase } from '@/lib/supabaseClient'\nimport { NextResponse } from 'next/server'\n\nexport async function POST(request: Request) {\n  try {\n    const body = await request.json()\n    const { studentId, email } = body\n\n    if (!studentId && !email) {\n      return NextResponse.json(\n        { success: false, error: 'Student ID or email is required' },\n        { status: 400 }\n      )\n    }\n\n    // Get student data\n    const { data: student, error: studentError } = await supabase\n      .from('users')\n      .select('*')\n      .eq('id', studentId || '')\n      .eq('email', email || '')\n      .single()\n\n    if (studentError || !student) {\n      return NextResponse.json(\n        { success: false, error: 'Student not found' },\n        { status: 404 }\n      )\n    }\n\n    // Get attendance records for this student\n    const { data: attendanceRecords, error: attendanceError } = await supabase\n      .from('attendance_records')\n      .select('*')\n      .eq('user_id', student.id)\n\n    // Calculate attendance rate\n    let attendanceRate = null\n    if (attendanceRecords && attendanceRecords.length > 0) {\n      const presentCount = attendanceRecords.filter(\n        (record: any) => record.status === 'present' || record.status === 'Present'\n      ).length\n      attendanceRate = (presentCount / attendanceRecords.length) * 100\n    }\n\n    // Get grades for this student\n    const { data: grades, error: gradesError } = await supabase\n      .from('grades')\n      .select('*')\n      .eq('student_id', student.id)\n\n    // Calculate GPA from grades\n    let gpa = null\n    if (grades && grades.length > 0) {\n      const totalGrade = grades.reduce((sum: number, grade: any) => {\n        const numericGrade = parseFloat(grade.grade)\n        return sum + (isNaN(numericGrade) ? 0 : numericGrade)\n      }, 0)\n      gpa = totalGrade / grades.length\n    }\n\n    // Dummy grades data for testing (fallback if no real data)\n    const dummyGrades = [\n      {\n        id: '1',\n        subject: 'Contemporary Philippine Arts from the Regions',\n        grade: '94',\n        lastUpdated: new Date().toISOString(),\n      },\n      {\n        id: '2',\n        subject: 'Media and Information Literacy',\n        grade: '94',\n        lastUpdated: new Date().toISOString(),\n      },\n      {\n        id: '3',\n        subject: 'Physical Education and Health',\n        grade: '97',\n        lastUpdated: new Date().toISOString(),\n      },\n      {\n        id: '4',\n        subject: 'Filipino sa Piling Larang',\n        grade: '95',\n        lastUpdated: new Date().toISOString(),\n      },\n      {\n        id: '5',\n        subject: 'Entrepreneurship',\n        grade: '95',\n        lastUpdated: new Date().toISOString(),\n      },\n      {\n        id: '6',\n        subject: 'Inquiries, Investigations and Immersion',\n        grade: '90',\n        lastUpdated: new Date().toISOString(),\n      },\n      {\n        id: '7',\n        subject: 'General Physics 2',\n        grade: '96',\n        lastUpdated: new Date().toISOString(),\n      },\n      {\n        id: '8',\n        subject: 'General Chemistry 2',\n        grade: '96',\n        lastUpdated: new Date().toISOString(),\n      },\n      {\n        id: '9',\n        subject: 'Work Immersion',\n        grade: '97',\n        lastUpdated: new Date().toISOString(),\n      },\n      {\n        id: '10',\n        subject: 'Practical Research 2',\n        grade: '90',\n        lastUpdated: new Date().toISOString(),\n      },\n    ]\n\n    // Count active courses (subjects with grades)\n    const activeCourses = grades?.length || 0\n\n    // Dummy dashboard data\n    const dashboardData = {\n      stats: {\n        gpa: gpa || 94.0,\n        attendanceRate: attendanceRate !== null ? attendanceRate : 95.5,\n        activeCourses: activeCourses || 10,\n        pendingTasks: 2,\n      },\n      assignments: [\n        {\n          id: '1',\n          title: 'Research Paper',\n          subject: 'Practical Research 2',\n          dueDate: new Date(Date.now() + 7 * 24 * 60 * 60 * 1000).toISOString(),\n          status: 'pending',\n        },\n        {\n          id: '2',\n          title: 'Business Plan',\n          subject: 'Entrepreneurship',\n          dueDate: new Date(Date.now() + 14 * 24 * 60 * 60 * 1000).toISOString(),\n          status: 'pending',\n        },\n      ],\n      courseProgress: [\n        {\n          id: '1',\n          subject: 'Contemporary Philippine Arts from the Regions',\n          completion: 85,\n          instructor: 'Prof. Santos',\n        },\n        {\n          id: '2',\n          subject: 'Media and Information Literacy',\n          completion: 90,\n          instructor: 'Prof. Garcia',\n        },\n        {\n          id: '3',\n          subject: 'Physical Education and Health',\n          completion: 95,\n          instructor: 'Coach Rodriguez',\n        },\n      ],\n      schedule: {\n        today: [\n          {\n            id: '1',\n            subject: 'Mathematics',\n            time: '8:00 AM',\n            location: 'Room 201',\n            instructor: 'Prof. Rodriguez',\n            accent: 'blue',\n          },\n          {\n            id: '2',\n            subject: 'Science',\n            time: '10:00 AM',\n            location: 'Lab 101',\n            instructor: 'Prof. Santos',\n            accent: 'green',\n          },\n        ],\n        events: [\n          {\n            id: '1',\n            title: 'Midterm Exams',\n            date: new Date(Date.now() + 30 * 24 * 60 * 60 * 1000).toISOString(),\n            description: 'Midterm examination week',\n            accent: 'red',\n          },\n        ],\n      },\n      grades: grades && grades.length > 0 \n        ? grades.map((g: any) => ({\n            id: g.id,\n            subject: g.subject,\n            grade: g.grade,\n            lastUpdated: g.updated_at || new Date().toISOString(),\n          }))\n        : dummyGrades,\n      enrollment: {\n        status: 'enrolled',\n        academicYear: '2024-2025',\n        semester: 'SECOND SEMESTER',\n        gradeLevel: '12',\n        strand: 'STEM',\n      },\n      subjects: [\n        { id: '1', subject: 'Contemporary Philippine Arts from the Regions', teacher: 'Prof. Maria Santos' },\n        { id: '2', subject: 'Media and Information Literacy', teacher: 'Prof. Juan Garcia' },\n        { id: '3', subject: 'Physical Education and Health', teacher: 'Coach Rodriguez' },\n        { id: '4', subject: 'Filipino sa Piling Larang', teacher: 'Prof. Ana Cruz' },\n        { id: '5', subject: 'Entrepreneurship', teacher: 'Prof. Carlos Reyes' },\n        { id: '6', subject: 'Inquiries, Investigations and Immersion', teacher: 'Prof. Lisa Torres' },\n        { id: '7', subject: 'General Physics 2', teacher: 'Prof. Robert Martinez' },\n        { id: '8', subject: 'General Chemistry 2', teacher: 'Prof. Patricia Lopez' },\n        { id: '9', subject: 'Work Immersion', teacher: 'Prof. Michael Brown' },\n        { id: '10', subject: 'Practical Research 2', teacher: 'Prof. Jennifer White' },\n      ],\n    }\n\n    return NextResponse.json({\n      success: true,\n      data: dashboardData,\n    })\n  } catch (error: any) {\n    console.error('Student dashboard API error:', error)\n    return NextResponse.json(\n      {\n        success: false,\n        error: error?.message || 'Internal server error',\n        data: {\n          stats: {\n            gpa: null,\n            attendanceRate: null,\n            activeCourses: null,\n            pendingTasks: null,\n          },\n          assignments: [],\n          courseProgress: [],\n          schedule: {\n            today: [],\n            events: [],\n          },\n          grades: [],\n          enrollment: {\n            status: 'unknown',\n            academicYear: '2024-2025',\n            semester: 'SECOND SEMESTER',\n            gradeLevel: null,\n            strand: null,\n          },\n          subjects: [],\n        },\n      },\n      { status: 500 }\n    )\n  }\n}\n\n"],"names":[],"mappings":"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"}}]
}